<!-- https://juejin.cn/post/6844903687165313031#heading-9 -->
<style>
  .box {
    width: 100px;
    height: 100px;
    background: red;
  }
</style>
<div class="box"></div>

<script>
  // 元素移动
  const box = document.querySelector('.box') // 获取方块元素
  let value = 0 // 设置初始值
  // 创建每一帧渲染之前要执行的方法
  const add = () => {
    requestAnimationFrame(add) // 下一帧渲染之前继续执行 add 方法
    value += 5 // 每帧加数值增加5
    box.style.transform = `translateX(${value}px)` // 将数值设置给 方块 的 css 属性 transform 属性可以控制元素在水平方向上的位移
  }
  requestAnimationFrame(add) // 下一帧渲染之前执行 add 方法

</script>



<script>
  // 小时候学过flash的朋友都知道补间动画，其实就是让小方块0px到300px平滑移动。其实就是固定的时间点，有固定的位置。
  // 所以我们只需要根据运动的已过时间的百分比去计算数值。
  /**
   *  执行补间动画方法
   *
   * @param      {Number}    start     开始数值
   * @param      {Number}    end       结束数值
   * @param      {Number}    time      补间时间
   * @param      {Function}  callback  每帧的回调函数
   */
  function animate(start, end, time, callback) {
    let startTime = performance.now() // 设置开始的时间戳
    let differ = end - start // 拿到数值差值
    // 创建每帧之前要执行的函数
    function loop() {
      raf = requestAnimationFrame(loop) // 下一阵调用每帧之前要执行的函数
      const passTime = performance.now() - startTime // 获取当前时间和开始时间差
      let per = passTime / time // 计算当前已过百分比
      if (per >= 1) { // 判读如果已经执行
        per = 1 // 设置为最后的状态
        cancelAnimationFrame(raf) // 停掉动画
      }
      const pass = differ * per // 通过已过时间百分比*开始结束数值差得出当前的数值
      callback(pass) // 调用回调函数，把数值传递进去
    }
    let raf = requestAnimationFrame(loop) // 下一阵调用每帧之前要执行的函数
  }

  let box = document.querySelector()
  animate(0, 400, 1000, value => {
    box.style.transform = `translateX(${value}px)` // 将数值设置给 方块 的 css 属性 transform 属性可以控制元素在水平方向上的位移
  })

</script>